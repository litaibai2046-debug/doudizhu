<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2685.3">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!doctype html&gt;</p>
<p class="p1">&lt;html lang="zh-CN"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;meta charset="utf-8" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;meta name="viewport" content="width=device-width,initial-scale=1" /&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;title&gt;æ–—åœ°ä¸»ï¼ˆç®€åŒ–å¯ç© Web ç‰ˆï¼‰&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>body{font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin:0;background:#0f172a;color:#e5e7eb}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>header{padding:16px 20px;border-bottom:1px solid #334155;display:flex;gap:12px;align-items:center}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>header h1{font-size:16px;margin:0;color:#fff}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>header .tag{font-size:12px;padding:4px 8px;border:1px solid #334155;border-radius:999px;color:#cbd5e1}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>main{display:grid;grid-template-columns: 1fr 340px;gap:14px;padding:14px;max-width:1200px;margin:0 auto}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.card{background:#111827;border:1px solid #334155;border-radius:14px;padding:14px}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.col{display:flex;flex-direction:column;gap:8px}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.muted{color:#94a3b8;font-size:12px}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.btn{border:1px solid #334155;background:#0b1220;color:#fff;padding:10px 12px;border-radius:12px;cursor:pointer}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.btn:hover{background:#0b1530}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.btn:disabled{opacity:.45;cursor:not-allowed}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.btn.primary{background:#2563eb;border-color:#2563eb}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.btn.primary:hover{background:#1d4ed8}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.btn.danger{background:#dc2626;border-color:#dc2626}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.btn.danger:hover{background:#b91c1c}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.pile{min-height:54px;border:1px dashed #334155;border-radius:14px;padding:10px;display:flex;gap:8px;flex-wrap:wrap}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.playingCard{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>user-select:none;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>display:inline-flex;align-items:center;justify-content:center;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>min-width:44px;height:54px;padding:0 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>background:#0b1220;border:1px solid #334155;border-radius:12px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>cursor:pointer;font-weight:600</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.playingCard.selected{outline:2px solid #22c55e;border-color:#22c55e}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.playingCard.small{min-width:30px;height:40px;font-size:12px;padding:0 6px;cursor:default}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.badge{font-size:12px;border:1px solid #334155;border-radius:999px;padding:4px 8px;color:#cbd5e1}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.log{height:420px;overflow:auto;white-space:pre-wrap;background:#0b1220;border:1px solid #334155;border-radius:14px;padding:10px;font-size:12px}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.hint{font-size:12px;color:#cbd5e1;line-height:1.5}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.split{display:flex;gap:10px;align-items:center;justify-content:space-between}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.aiHand{display:flex;gap:6px;flex-wrap:wrap}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.win{font-size:18px;color:#22c55e;font-weight:700}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.lose{font-size:18px;color:#f97316;font-weight:700}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p1">&lt;header&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;h1&gt;æ–—åœ°ä¸»ï¼ˆç®€åŒ–å¯ç© Web ç‰ˆï¼‰&lt;/h1&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;span class="tag"&gt;ä½  vs 2 AI&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;span class="tag"&gt;æ”¯æŒï¼šå•/å¯¹/ä¸‰/ä¸‰å¸¦ä¸€/ä¸‰å¸¦äºŒ&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;span class="tag"&gt;ä¸æ”¯æŒï¼šé¡ºå­/è¿å¯¹/ç‚¸å¼¹/é£æœº/å«åœ°ä¸»&lt;/span&gt;</p>
<p class="p1">&lt;/header&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;main&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;section class="card col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="split"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;span class="badge" id="turnBadge"&gt;å›åˆï¼š-&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;span class="badge" id="lastBadge"&gt;ä¸Šä¸€æ‰‹ï¼š-&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button class="btn primary" id="newBtn"&gt;æ–°å¼€ä¸€å±€&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button class="btn" id="passBtn"&gt;è¿‡ç‰Œ&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button class="btn danger" id="playBtn"&gt;å‡ºç‰Œ&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="row"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="col" style="flex:1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="muted"&gt;AI-1ï¼ˆå‰© &lt;span id="ai1Count"&gt;0&lt;/span&gt; å¼ ï¼‰&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="aiHand" id="ai1Hand"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="col" style="flex:1"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="muted"&gt;AI-2ï¼ˆå‰© &lt;span id="ai2Count"&gt;0&lt;/span&gt; å¼ ï¼‰&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="aiHand" id="ai2Hand"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="muted"&gt;ç‰Œæ¡Œï¼ˆå½“å‰è½®æ¬¡å‡ºçš„ç‰Œï¼‰&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="pile" id="tablePile"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="muted"&gt;ä½ çš„æ‰‹ç‰Œï¼ˆç‚¹å‡»é€‰ä¸­ï¼Œæ”¯æŒå¤šé€‰ï¼‰&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="pile" id="myPile"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="hint"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>è§„åˆ™æç¤ºï¼š&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>1) ä½ æ˜¯â€œåœ°ä¸»â€ï¼ˆå…ˆæ‰‹ï¼Œæ‰‹ç‰Œ 20 å¼ ï¼‰ã€‚&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>2) é¦–å‡ºä¸èƒ½è¿‡ç‰Œã€‚&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>3) åªèƒ½ç”¨ç›¸åŒç‰Œå‹å‹åˆ¶ä¸Šä¸€æ‰‹ã€‚&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>4) å¦‚æœæ‰€æœ‰äººéƒ½è¿‡ç‰Œï¼Œè½®æ¬¡é‡ç½®ï¼Œé‡æ–°é¦–å‡ºã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div id="result" style="margin-top:6px;"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/section&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;aside class="card col"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="split"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;div class="muted"&gt;æ—¥å¿—&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;button class="btn" id="clearLogBtn"&gt;æ¸…ç©º&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="log" id="log"&gt;&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="hint"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>è¿™æ˜¯â€œå¯ç©ç‰ˆâ€ã€‚è¦å‡çº§åˆ°å®Œæ•´ç‰ˆï¼ˆå«åœ°ä¸»/é¡ºå­/ç‚¸å¼¹/é£æœº/æ›´å¼º AIï¼‰ï¼Œæˆ‘ä¹Ÿèƒ½ç»§ç»­ç»™ä½ è¿­ä»£ã€‚</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/aside&gt;</p>
<p class="p1">&lt;/main&gt;</p>
<p class="p2"><br></p>
<p class="p1">&lt;script&gt;</p>
<p class="p1">(() =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const RANKS = ['3','4','5','6','7','8','9','10','J','Q','K','A','2','SJ','BJ'];</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const RANK_VALUE = Object.fromEntries(RANKS.map((r,i)=&gt;[r,i]));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const els = {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>myPile: document.getElementById('myPile'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>tablePile: document.getElementById('tablePile'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>ai1Hand: document.getElementById('ai1Hand'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>ai2Hand: document.getElementById('ai2Hand'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>ai1Count: document.getElementById('ai1Count'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>ai2Count: document.getElementById('ai2Count'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>turnBadge: document.getElementById('turnBadge'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>lastBadge: document.getElementById('lastBadge'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>log: document.getElementById('log'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>result: document.getElementById('result'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>newBtn: document.getElementById('newBtn'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>playBtn: document.getElementById('playBtn'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>passBtn: document.getElementById('passBtn'),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>clearLogBtn: document.getElementById('clearLogBtn'),</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let hands = [[],[],[]]; // 0: you, 1: ai1, 2: ai2</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let selected = new Set(); // selected indices in your hand</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let turn = 0; // 0 you, 1 ai1, 2 ai2</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let last = null; // {type,cards,main}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>let lastPlayer = null; // last non-pass player index</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function log(msg){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>els.log.textContent += msg + "\n";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>els.log.scrollTop = els.log.scrollHeight;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function buildDeck(){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const deck = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (const r of RANKS.slice(0,-2)) for (let i=0;i&lt;4;i++) deck.push(r);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>deck.push('SJ','BJ');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (let i=deck.length-1;i&gt;0;i--){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const j = Math.floor(Math.random()*(i+1));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>[deck[i],deck[j]] = [deck[j],deck[i]];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return deck;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function sortHand(hand){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>hand.sort((a,b)=&gt;RANK_VALUE[a]-RANK_VALUE[b]);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return hand;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function classify(cards){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (!cards || !cards.length) return null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const c = {};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (const r of cards) c[r]=(c[r]||0)+1;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const counts = Object.values(c).sort((a,b)=&gt;b-a);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const keys = Object.keys(c);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (cards.length === 1) return {type:"single", cards:[...cards], main: cards[0]};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (cards.length === 2 &amp;&amp; keys.length === 1) return {type:"pair", cards:[...cards], main: keys[0]};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (cards.length === 3 &amp;&amp; keys.length === 1) return {type:"triple", cards:[...cards], main: keys[0]};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (cards.length === 4 &amp;&amp; counts.join(',') === '3,1'){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const main = keys.find(k=&gt;c[k]===3);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return {type:"triple_single", cards:[...cards], main};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (cards.length === 5 &amp;&amp; counts.join(',') === '3,2'){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const main = keys.find(k=&gt;c[k]===3);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return {type:"triple_pair", cards:[...cards], main};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return null;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function beats(a,b){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (!b) return true;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (a.type !== b.type) return false;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return RANK_VALUE[a.main] &gt; RANK_VALUE[b.main];</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function canRemove(hand, cards){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const c = {};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (const r of hand) c[r]=(c[r]||0)+1;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (const r of cards){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>if (!c[r]) return false;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>c[r]--;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return true;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function removeCards(hand, cards){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (const r of cards){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const idx = hand.indexOf(r);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>if (idx&gt;=0) hand.splice(idx,1);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function aiPlay(hand, lastHand){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>sortHand(hand);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const counts = {};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (const r of hand) counts[r]=(counts[r]||0)+1;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const ranks = Object.keys(counts).sort((a,b)=&gt;RANK_VALUE[a]-RANK_VALUE[b]);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const plays = [];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// singles</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (const r of ranks) plays.push({type:"single", cards:[r], main:r});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// pairs</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (const r of ranks) if (counts[r]&gt;=2) plays.push({type:"pair", cards:[r,r], main:r});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// triples</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (const r of ranks) if (counts[r]&gt;=3) plays.push({type:"triple", cards:[r,r,r], main:r});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// triple+single</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (const r of ranks){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>if (counts[r]&gt;=3){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const s = ranks.find(x=&gt;x!==r &amp;&amp; counts[x]&gt;=1);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (s) plays.push({type:"triple_single", cards:[r,r,r,s], main:r});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// triple+pair</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>for (const r of ranks){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>if (counts[r]&gt;=3){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const p = ranks.find(x=&gt;x!==r &amp;&amp; counts[x]&gt;=2);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (p) plays.push({type:"triple_pair", cards:[r,r,r,p,p], main:r});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (!lastHand){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const order = {triple_pair:0, triple_single:1, triple:2, pair:3, single:4};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>plays.sort((x,y)=&gt; (order[x.type]-order[y.type]) || (RANK_VALUE[x.main]-RANK_VALUE[y.main]));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return plays[0] || null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const same = plays.filter(p=&gt;p.type===lastHand.type &amp;&amp; beats(p,lastHand));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>same.sort((x,y)=&gt;RANK_VALUE[x.main]-RANK_VALUE[y.main]);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return same[0] || null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function render(){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>els.ai1Count.textContent = hands[1].length;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>els.ai2Count.textContent = hands[2].length;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>els.turnBadge.textContent = `å›åˆï¼š${turn===0?'ä½ (åœ°ä¸»)':turn===1?'AI-1':'AI-2'}`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (!last) els.lastBadge.textContent = "ä¸Šä¸€æ‰‹ï¼šæ— ";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>else els.lastBadge.textContent = `ä¸Šä¸€æ‰‹ï¼š${labelType(last.type)} ${last.cards.join(' ')}ï¼ˆä¸»:${last.main}ï¼‰`;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// table</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>els.tablePile.innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (last){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>for (const r of last.cards){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const el = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>el.className = "playingCard small";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>el.textContent = r;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>els.tablePile.appendChild(el);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// AIs show as back cards</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const renderAI = (container, n) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>container.innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>for (let i=0;i&lt;Math.min(n, 20); i++){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const el = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>el.className = "playingCard small";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>el.textContent = "ğŸ‚ ";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>container.appendChild(el);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>if (n&gt;20){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const el = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>el.className = "playingCard small";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>el.textContent = `+${n-20}`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>container.appendChild(el);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>renderAI(els.ai1Hand, hands[1].length);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>renderAI(els.ai2Hand, hands[2].length);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// you</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>els.myPile.innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>sortHand(hands[0]);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>hands[0].forEach((r,idx)=&gt;{</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const el = document.createElement('div');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>el.className = "playingCard" + (selected.has(idx) ? " selected" : "");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>el.textContent = r;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>el.onclick = () =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (turn !== 0) return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (selected.has(idx)) selected.delete(idx); else selected.add(idx);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>render();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>els.myPile.appendChild(el);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// button states</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>els.playBtn.disabled = (turn !== 0);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>els.passBtn.disabled = (turn !== 0) || (last === null); // first lead cannot pass</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function labelType(t){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return ({</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>single:"å•å¼ ",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>pair:"å¯¹å­",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>triple:"ä¸‰å¼ ",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>triple_single:"ä¸‰å¸¦ä¸€",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>triple_pair:"ä¸‰å¸¦äºŒ"</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>})[t] || t;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function setResult(html){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>els.result.innerHTML = html || "";</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function checkWin(){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (hands[0].length === 0){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>setResult(`&lt;div class="win"&gt;ğŸ ä½ èµ¢äº†ï¼&lt;/div&gt;`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return true;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (hands[1].length === 0){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>setResult(`&lt;div class="lose"&gt;ğŸ AI-1 èµ¢äº†ï¼&lt;/div&gt;`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return true;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (hands[2].length === 0){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>setResult(`&lt;div class="lose"&gt;ğŸ AI-2 èµ¢äº†ï¼&lt;/div&gt;`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return true;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>return false;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function resetTrickIfNeeded(nextTurn){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (lastPlayer !== null &amp;&amp; nextTurn === lastPlayer){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>last = null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>lastPlayer = null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>log("âœ… ä¸€è½®ç»“æŸï¼Œé‡æ–°é¦–å‡ºã€‚");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>async function stepAI(){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (checkWin()) return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (turn === 0) { render(); return; }</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// small delay for feel</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>await new Promise(r=&gt;setTimeout(r, 350));</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const h = hands[turn];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const play = aiPlay(h, last);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (!play){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>if (!last){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>// force lead (shouldn't happen)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const forced = aiPlay(h, null);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (forced){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>removeCards(h, forced.cards);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>last = forced;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>lastPlayer = turn;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>log(`${turn===1?'AI-1':'AI-2'} å‡ºç‰Œï¼š${forced.cards.join(' ')}ï¼ˆ${labelType(forced.type)} ä¸»:${forced.main}ï¼‰`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>log(`${turn===1?'AI-1':'AI-2'} è¿‡ç‰Œã€‚`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>removeCards(h, play.cards);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>last = play;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>lastPlayer = turn;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>log(`${turn===1?'AI-1':'AI-2'} å‡ºç‰Œï¼š${play.cards.join(' ')}ï¼ˆ${labelType(play.type)} ä¸»:${play.main}ï¼‰`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const next = (turn + 1) % 3;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>resetTrickIfNeeded(next);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>turn = next;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>render();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (turn !== 0 &amp;&amp; !checkWin()) stepAI();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function newGame(){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>setResult("");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>selected.clear();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const deck = buildDeck();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>hands = [</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>deck.slice(0,17),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>deck.slice(17,34),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>deck.slice(34,51),</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// give you 3 extra as "landlord"</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>hands[0] = hands[0].concat(deck.slice(51));</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>hands.forEach(sortHand);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>turn = 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>last = null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>lastPlayer = null;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>els.log.textContent = "";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>log("ğŸ® æ–°å¼€ä¸€å±€ï¼šä½ æ˜¯åœ°ä¸»ï¼ˆå…ˆæ‰‹ 20 å¼ ï¼‰ã€‚");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>render();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function playSelected(){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (turn !== 0) return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const idxs = Array.from(selected).sort((a,b)=&gt;a-b);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (!idxs.length){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>setResult(`&lt;div class="muted"&gt;æ²¡é€‰ç‰Œã€‚&lt;/div&gt;`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const cards = idxs.map(i=&gt;hands[0][i]);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (!canRemove(hands[0], cards)){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>setResult(`&lt;div class="muted"&gt;é€‰ç‰Œå¼‚å¸¸ï¼ˆè¯·é‡é€‰ï¼‰ã€‚&lt;/div&gt;`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>selected.clear();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>render();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const h = classify(cards);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (!h){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>setResult(`&lt;div class="muted"&gt;ä¸æ”¯æŒçš„ç‰Œå‹ã€‚åªæ”¯æŒï¼šå•/å¯¹/ä¸‰/ä¸‰å¸¦ä¸€/ä¸‰å¸¦äºŒã€‚&lt;/div&gt;`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (last &amp;&amp; !beats(h, last)){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>setResult(`&lt;div class="muted"&gt;å‹ä¸ä½ä¸Šä¸€æ‰‹ï¼ˆæˆ–ç‰Œå‹ä¸ä¸€è‡´ï¼‰ã€‚&lt;/div&gt;`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>// lead cannot pass already handled</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>removeCards(hands[0], cards);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>last = h;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>lastPlayer = 0;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>log(`ä½  å‡ºç‰Œï¼š${cards.join(' ')}ï¼ˆ${labelType(h.type)} ä¸»:${h.main}ï¼‰`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>selected.clear();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const next = 1;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>turn = next;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>render();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (!checkWin()) stepAI();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>function pass(){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (turn !== 0) return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (!last){</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>setResult(`&lt;div class="muted"&gt;é¦–å‡ºä¸èƒ½è¿‡ç‰Œã€‚&lt;/div&gt;`);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>log("ä½  è¿‡ç‰Œã€‚");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>selected.clear();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const next = 1;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>resetTrickIfNeeded(next);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>turn = next;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>render();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>if (!checkWin()) stepAI();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>// Wire</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>els.newBtn.onclick = newGame;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>els.playBtn.onclick = playSelected;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>els.passBtn.onclick = pass;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>els.clearLogBtn.onclick = () =&gt; els.log.textContent = "";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>// Start</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>newGame();</p>
<p class="p1">})();</p>
<p class="p1">&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
